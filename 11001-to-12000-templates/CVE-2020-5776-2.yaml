id: CVE-2020-57762

info:
  name: Cross Site Request Forgery (CSRF) in MAGMI (Magento Mass Importer) Plugin
  author: dwisiswant0
  severity: high
  description: Currently, all versions of MAGMI are vulnerable to CSRF due to the lack of CSRF tokens. RCE (via phpcli command) is possible in the event that a CSRF is leveraged against an existing admin session for MAGMI.
  reference: https://www.tenable.com/security/research/tra-2020-51
  tags: cve,cve2020,magmi,magento

  # Due to the lack of CSRF tokens, RCE (via phpcli command) is possible
  # in the event that a CSRF is leveraged against an existing admin session for MAGMI.
  # At the time of this advisory, no patch exists for this issue.


requests:
  - raw:
      - |
        POST /magmi/web/magmi_run.php HTTP/1.1
        Host: {{Hostname}}
        Content-type: application/x-www-form-urlencoded
        Connection: close

        engine=magmi_productimportengine%3AMagmi_ProductImportEngine&ts=1598879870&run=import&logfile=progress.txt&profile=default&mode=update
      - |
        GET /magmi/web/info.php HTTP/1.1
        Host: {{Hostname}}
    matchers-condition: and
    matchers:
      - type: word
        words:
          - "PHP Extension"
          - "PHP Version"
        condition: and
      - type: status
        status:
          - 200